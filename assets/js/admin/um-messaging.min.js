jQuery(function(){var e,s,_,n=jQuery("#um_options_pm_encryption");n.length&&(e=n.is(":checked"),n.on("change",function(){e===n.is(":checked")?n.siblings(".um-same-page-update-encrypt_messages").hide():n.siblings(".um-same-page-update-encrypt_messages").show()}),s="encrypt_messages",_={count:0,current_page:0,pages:0,per_page:0},wp.hooks.addAction("um_same_page_upgrade","um-messaging",function(e){e===s&&wp.ajax.send("um_same_page_update",{data:{cb_func:"um_encrypt_messages_start",checked:+n.is(":checked"),nonce:um_admin_scripts.nonce},beforeSend:function(){um_add_same_page_log(s,wp.i18n.__("Getting messages...","um-messaging"))},success:function(e){e?(jQuery.extend(_,e),um_add_same_page_log(s,wp.i18n.__("There are ","um-messaging")+_.count+wp.i18n.__(" messages...","um-messaging")),um_add_same_page_log(s,wp.i18n.__("Start messages updating...","um-messaging")),_.pages=Math.ceil(_.count/_.per_page),function a(){_.current_page++;if(_.current_page>_.pages)return um_add_same_page_log(s,wp.i18n.__("Done.","um-messaging")),void window.location.reload();wp.ajax.send("um_same_page_update",{data:{cb_func:"um_encrypt_messages_update",checked:+n.is(":checked"),page:_.current_page,pages:_.pages,nonce:um_admin_scripts.nonce},success:function(e){e?(um_add_same_page_log(s,e.message),a()):um_same_page_wrong_ajax(s)},error:function(){um_same_page_something_wrong(s)}})}()):um_same_page_wrong_ajax(s)},error:function(){um_same_page_something_wrong(s)}})},10))});